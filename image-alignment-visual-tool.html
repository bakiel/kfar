<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KFAR Image-Description Alignment Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .vendor-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .vendor-name {
            font-size: 24px;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 15px;
        }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .product-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #fafafa;
        }
        .product-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            background: white;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .product-info {
            font-size: 14px;
        }
        .product-id {
            font-weight: bold;
            color: #3498db;
        }
        .product-name {
            margin: 5px 0;
        }
        .issue {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 10px;
        }
        .fix-needed {
            background-color: #fee;
            border-color: #faa;
        }
        .mapping-needed {
            background-color: #fef;
            border-color: #faf;
        }
        .missing-image {
            background-color: #ffe;
            border-color: #ffa;
        }
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        button {
            padding: 10px 20px;
            margin: 0 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn-primary {
            background: #3498db;
            color: white;
        }
        .btn-success {
            background: #27ae60;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>KFAR Marketplace - Image-Description Alignment Tool</h1>
        
        <div class="controls">
            <button class="btn-primary" onclick="loadData()">Load Current Data</button>
            <button class="btn-success" onclick="exportFixes()">Export Fixes</button>
        </div>

        <div id="content">
            <!-- Garden of Light Section -->
            <div class="vendor-section">
                <div class="vendor-name">Garden of Light - Priority Fixes</div>
                <div class="product-grid">
                    <div class="product-card fix-needed">
                        <img src="/images/vendors/garden-of-light/products/2.jpg" class="product-image" alt="Product 2">
                        <div class="product-info">
                            <div class="product-id">gol-002</div>
                            <div class="product-name">Current: Kalbono Protein Salad</div>
                            <div class="product-name">Should be: Kelbone Protein Salad</div>
                            <div class="issue">✗ Spelling Error</div>
                        </div>
                    </div>
                    
                    <div class="product-card mapping-needed">
                        <img src="/images/vendors/garden-of-light/products/3.jpg" class="product-image" alt="Product 3">
                        <div class="product-info">
                            <div class="product-id">gol-003</div>
                            <div class="product-name">Protein White Salad</div>
                            <div class="issue">? Check if duplicate of product 2</div>
                        </div>
                    </div>
                    
                    <div class="product-card missing-image">
                        <img src="/images/vendors/garden-of-light/products/12.jpg" class="product-image" alt="Product 12">
                        <div class="product-info">
                            <div class="product-id">gol-012</div>
                            <div class="product-name">Product Name Unknown</div>
                            <div class="issue">✗ Shows logo instead of product</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teva Deli Section -->
            <div class="vendor-section">
                <div class="vendor-name">Teva Deli - Unmapped Products (Sample)</div>
                <div class="product-grid">
                    <div class="product-card mapping-needed">
                        <div class="product-info">
                            <div class="product-id">Image: specialty_product_01</div>
                            <div class="product-name">Identified: Seitan Amaranth</div>
                            <div class="product-name">Map to: td-001</div>
                            <div class="issue">✓ Ready to map</div>
                        </div>
                    </div>
                    
                    <div class="product-card mapping-needed">
                        <div class="product-info">
                            <div class="product-id">Image: specialty_product_11</div>
                            <div class="product-name">Identified: Vegetarian Hot Dogs</div>
                            <div class="product-name">Map to: td-hot-dogs</div>
                            <div class="issue">✓ Ready to map</div>
                        </div>
                    </div>
                    
                    <div class="product-card mapping-needed">
                        <div class="product-info">
                            <div class="product-id">Image: specialty_product_21</div>
                            <div class="product-name">Identified: Okara Patties</div>
                            <div class="product-name">Map to: td-okara-patties</div>
                            <div class="issue">✓ Ready to map</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary Section -->
            <div class="vendor-section">
                <div class="vendor-name">Summary</div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    <div style="text-align: center; padding: 20px; background: #fee; border-radius: 8px;">
                        <h3>Fixes Needed</h3>
                        <p style="font-size: 36px; margin: 0;">3</p>
                        <p>Description mismatches</p>
                    </div>
                    <div style="text-align: center; padding: 20px; background: #fef; border-radius: 8px;">
                        <h3>Unmapped Images</h3>
                        <p style="font-size: 36px; margin: 0;">43</p>
                        <p>Teva Deli products</p>
                    </div>
                    <div style="text-align: center; padding: 20px; background: #ffe; border-radius: 8px;">
                        <h3>Missing Images</h3>
                        <p style="font-size: 36px; margin: 0;">9</p>
                        <p>Products without images</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function loadData() {
            alert('Loading current catalog and image data...\nRun: node scripts/image-alignment-checker.js');
        }

        function exportFixes() {
            const fixes = {
                timestamp: new Date().toISOString(),
                fixes: [
                    {
                        vendor: 'garden-of-light',
                        productId: 'gol-002',
                        updates: {
                            name: 'Kelbone Protein Salad',
                            nameHe: 'סלט חלבון קלבון'
                        }
                    }
                ],
                imageMappings: {
                    'teva-deli': {
                        'specialty_product_01': 'td-001',
                        'specialty_product_11': 'td-hot-dogs',
                        'specialty_product_21': 'td-okara-patties'
                    }
                }
            };
            
            const dataStr = JSON.stringify(fixes, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'kfar-image-fixes.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Load images dynamically when running on local server
        if (window.location.protocol === 'http:' || window.location.protocol === 'https:') {
            console.log('Running on server - images will load from public directory');
        } else {
            console.log('Open this file using: python -m http.server 8080');
        }
    </script>
</body>
</html>
